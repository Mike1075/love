<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åª’ä½“æ–‡ä»¶ç®¡ç† - çœŸçˆ±ä¹‹æ—…</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .nav-links {
            text-align: center;
            margin-bottom: 30px;
        }

        .nav-links a {
            color: #ffd700;
            text-decoration: none;
            margin: 0 15px;
            padding: 10px 20px;
            border: 2px solid #ffd700;
            border-radius: 25px;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .nav-links a:hover {
            background: #ffd700;
            color: #333;
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .upload-area {
            border: 3px dashed rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.7;
        }

        .upload-text {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 1rem;
            opacity: 0.7;
        }

        .file-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .slide-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .slide-selector label {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .slide-selector select {
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1rem;
            cursor: pointer;
        }

        .slide-selector select option {
            background: #333;
            color: white;
        }

        .progress-container {
            margin-top: 20px;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            width: 0;
            transition: width 0.3s ease;
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .media-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .media-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }

        .media-preview {
            width: 100%;
            height: 150px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .media-preview img,
        .media-preview video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .media-preview .placeholder {
            font-size: 2rem;
            opacity: 0.5;
        }

        .media-info {
            text-align: center;
        }

        .media-info h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .media-info p {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .media-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4facfe;
            color: white;
        }

        .btn-danger {
            background: #ff6b6b;
            color: white;
        }

        .btn:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }

        .status-message {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .status-success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid rgba(76, 175, 80, 0.5);
        }

        .status-error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.5);
        }

        .slide-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .slide-info h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .slide-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            font-size: 0.9rem;
        }

        .slide-item {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            border-left: 4px solid #ffd700;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .upload-area {
                padding: 40px 15px;
            }

            .media-grid {
                grid-template-columns: 1fr;
            }

            .slide-selector {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ åª’ä½“æ–‡ä»¶ç®¡ç†</h1>
            <p>ä¸ºå¹»ç¯ç‰‡æ·»åŠ ç²¾ç¾çš„è§†é¢‘å’Œå›¾ç‰‡</p>
        </div>

        <div class="nav-links">
            <a href="index.html">ğŸ¬ è¿”å›å¹»ç¯ç‰‡</a>
            <a href="test.html">ğŸ§ª æµ‹è¯•é¡µé¢</a>
            <a href="#" onclick="window.open('https://github.com/Mike1075/love', '_blank')">ğŸ“‚ é¡¹ç›®æºç </a>
        </div>

        <div class="status-message" id="statusMessage"></div>

        <div class="slide-info">
            <h3>ğŸ“‹ å¹»ç¯ç‰‡åˆ—è¡¨</h3>
            <div class="slide-list">
                <div class="slide-item">1. çˆ±ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</div>
                <div class="slide-item">2. ä½ ä¸ä½ çš„èº«ä½“ï¼Œæ˜¯æœ‹å‹å—ï¼Ÿ</div>
                <div class="slide-item">3. ä½ ç”Ÿå‘½ä¸­æœ€å¼ºå¤§çš„åŠ›é‡</div>
                <div class="slide-item">4. çœŸçˆ±ä¹‹æ—… (æ ‡é¢˜é¡µ)</div>
                <div class="slide-item">5. æ¬¢è¿ï¼Œå‹‡æ•¢çš„æ¢ç´¢è€…</div>
                <div class="slide-item">6. æˆ‘ä»¬ç¥åœ£çš„çº¦å®š</div>
                <div class="slide-item">7. ç»ƒä¹ ä¸€ï¼šå¿ƒä¹‹æ‰€å‘</div>
                <div class="slide-item">8. å‘å¤–ç´¢å–çš„å•†å“ï¼Ÿ</div>
                <div class="slide-item">9. æ€§èƒ½é‡ = ç”Ÿå‘½åŠ›</div>
                <div class="slide-item">10. è¢«å µå¡çš„ç”Ÿå‘½ä¹‹æ²³</div>
                <div class="slide-item">11. ç»ƒä¹ äºŒï¼šå†™ç»™èº«ä½“çš„å¿æ‚”å½•</div>
                <div class="slide-item">12. é˜´ä¸é˜³çš„å†…åœ¨å…±èˆ</div>
                <div class="slide-item">13. å¤´è„‘æ§åˆ¶èº«ä½“ï¼Ÿ</div>
                <div class="slide-item">14. ç»ƒä¹ ä¸‰ï¼šåŠ¨æ€é™å¿ƒ</div>
                <div class="slide-item">15. ç¬¬ä¸€é˜¶æ®µï¼šæ··ä¹±å¼å‘¼å¸</div>
                <div class="slide-item">16. ç¬¬äºŒé˜¶æ®µï¼šèƒ½é‡å®£æ³„</div>
                <div class="slide-item">17. ç¬¬ä¸‰é˜¶æ®µï¼šé™æ­¢ä¸è§‚ç…§</div>
                <div class="slide-item">18. ç¬¬å››é˜¶æ®µï¼šåº†ç¥ä¹‹èˆ</div>
                <div class="slide-item">19. é™é»˜åˆé¤</div>
                <div class="slide-item">20. å…‰è¿›å…¥ä½ å†…å¿ƒçš„åœ°æ–¹</div>
                <div class="slide-item">21. åˆ›ä¼¤çš„æœ¬è´¨</div>
                <div class="slide-item">22. ç»ƒä¹ å››ï¼šå¿ƒä¸æ ¹çš„è¿æ¥</div>
                <div class="slide-item">23. å…³ç³»ï¼Œæ˜¯é€šå¾€è‡ªæˆ‘çš„æ¡¥æ¢</div>
                <div class="slide-item">24. ç»ƒä¹ äº”ï¼šçµé­‚çš„å‡è§†</div>
                <div class="slide-item">25. é‡ç”Ÿä¹‹æ—…</div>
                <div class="slide-item">26. æ„å›¾å¼•å¯¼</div>
                <div class="slide-item">27. ç¬¬ä¸€æ­¥ï¼šè¿æ¥</div>
                <div class="slide-item">28. ç¬¬äºŒæ­¥ï¼šå›é¡¾ä¸å‘Šåˆ«</div>
                <div class="slide-item">29. ç¬¬ä¸‰æ­¥ï¼šæ–°ç”Ÿä¸åº†ç¥</div>
                <div class="slide-item">30. ç¬¬å››æ­¥ï¼šæ‹¥æŠ±ä¸èåˆ</div>
                <div class="slide-item">31. æ—…ç¨‹ï¼Œç°åœ¨æ‰çœŸæ­£å¼€å§‹</div>
                <div class="slide-item">32. æ„Ÿè°¢æ‚¨çš„ä¸´åœ¨ä¸æ•å¼€</div>
            </div>
        </div>

        <div class="upload-section">
            <h2>ğŸ“¤ ä¸Šä¼ åª’ä½“æ–‡ä»¶</h2>
            
            <div class="slide-selector">
                <label for="slideSelect">é€‰æ‹©å¹»ç¯ç‰‡ï¼š</label>
                <select id="slideSelect">
                    <option value="">è¯·é€‰æ‹©å¹»ç¯ç‰‡ç¼–å·...</option>
                </select>
                <span id="slideTitle" style="font-style: italic; opacity: 0.8;"></span>
            </div>

            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-text">æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œæˆ–ç‚¹å‡»é€‰æ‹©</div>
                <div class="upload-hint">æ”¯æŒ MP4, WebM, OGG è§†é¢‘å’Œ JPG, PNG, WebP å›¾ç‰‡</div>
                <input type="file" id="fileInput" class="file-input" multiple accept="video/*,image/*">
            </div>

            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>

        <div class="media-grid" id="mediaGrid">
            <!-- åª’ä½“æ–‡ä»¶å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <script>
        class MediaUploadManager {
            constructor() {
                this.mediaFiles = new Map();
                this.slideNames = [
                    "", // 0 - å ä½ç¬¦
                    "çˆ±ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ",
                    "ä½ ä¸ä½ çš„èº«ä½“ï¼Œæ˜¯æœ‹å‹å—ï¼Ÿ",
                    "ä½ ç”Ÿå‘½ä¸­æœ€å¼ºå¤§çš„åŠ›é‡",
                    "çœŸçˆ±ä¹‹æ—… (æ ‡é¢˜é¡µ)",
                    "æ¬¢è¿ï¼Œå‹‡æ•¢çš„æ¢ç´¢è€…",
                    "æˆ‘ä»¬ç¥åœ£çš„çº¦å®š",
                    "ç»ƒä¹ ä¸€ï¼šå¿ƒä¹‹æ‰€å‘",
                    "å‘å¤–ç´¢å–çš„å•†å“ï¼Ÿ",
                    "æ€§èƒ½é‡ = ç”Ÿå‘½åŠ›",
                    "è¢«å µå¡çš„ç”Ÿå‘½ä¹‹æ²³",
                    "ç»ƒä¹ äºŒï¼šå†™ç»™èº«ä½“çš„å¿æ‚”å½•",
                    "é˜´ä¸é˜³çš„å†…åœ¨å…±èˆ",
                    "å¤´è„‘æ§åˆ¶èº«ä½“ï¼Ÿ",
                    "ç»ƒä¹ ä¸‰ï¼šåŠ¨æ€é™å¿ƒ",
                    "ç¬¬ä¸€é˜¶æ®µï¼šæ··ä¹±å¼å‘¼å¸",
                    "ç¬¬äºŒé˜¶æ®µï¼šèƒ½é‡å®£æ³„",
                    "ç¬¬ä¸‰é˜¶æ®µï¼šé™æ­¢ä¸è§‚ç…§",
                    "ç¬¬å››é˜¶æ®µï¼šåº†ç¥ä¹‹èˆ",
                    "é™é»˜åˆé¤",
                    "å…‰è¿›å…¥ä½ å†…å¿ƒçš„åœ°æ–¹",
                    "åˆ›ä¼¤çš„æœ¬è´¨",
                    "ç»ƒä¹ å››ï¼šå¿ƒä¸æ ¹çš„è¿æ¥",
                    "å…³ç³»ï¼Œæ˜¯é€šå¾€è‡ªæˆ‘çš„æ¡¥æ¢",
                    "ç»ƒä¹ äº”ï¼šçµé­‚çš„å‡è§†",
                    "é‡ç”Ÿä¹‹æ—…",
                    "æ„å›¾å¼•å¯¼",
                    "ç¬¬ä¸€æ­¥ï¼šè¿æ¥",
                    "ç¬¬äºŒæ­¥ï¼šå›é¡¾ä¸å‘Šåˆ«",
                    "ç¬¬ä¸‰æ­¥ï¼šæ–°ç”Ÿä¸åº†ç¥",
                    "ç¬¬å››æ­¥ï¼šæ‹¥æŠ±ä¸èåˆ",
                    "æ—…ç¨‹ï¼Œç°åœ¨æ‰çœŸæ­£å¼€å§‹",
                    "æ„Ÿè°¢æ‚¨çš„ä¸´åœ¨ä¸æ•å¼€"
                ];
                
                this.init();
            }

            init() {
                this.setupElements();
                this.bindEvents();
                this.populateSlideSelector();
                this.loadExistingMedia();
            }

            setupElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.slideSelect = document.getElementById('slideSelect');
                this.slideTitle = document.getElementById('slideTitle');
                this.progressContainer = document.getElementById('progressContainer');
                this.progressFill = document.getElementById('progressFill');
                this.statusMessage = document.getElementById('statusMessage');
                this.mediaGrid = document.getElementById('mediaGrid');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
                this.fileInput.addEventListener('change', (e) => this.handleFiles(e.target.files));
                
                // æ‹–æ‹½äº‹ä»¶
                this.uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.add('dragover');
                });
                
                this.uploadArea.addEventListener('dragleave', () => {
                    this.uploadArea.classList.remove('dragover');
                });
                
                this.uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.remove('dragover');
                    this.handleFiles(e.dataTransfer.files);
                });

                // å¹»ç¯ç‰‡é€‰æ‹©äº‹ä»¶
                this.slideSelect.addEventListener('change', (e) => {
                    const slideNumber = parseInt(e.target.value);
                    if (slideNumber) {
                        this.slideTitle.textContent = this.slideNames[slideNumber];
                    } else {
                        this.slideTitle.textContent = '';
                    }
                });
            }

            populateSlideSelector() {
                for (let i = 1; i <= 32; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `ç¬¬${i}å¼  - ${this.slideNames[i]}`;
                    this.slideSelect.appendChild(option);
                }
            }

            handleFiles(files) {
                Array.from(files).forEach(file => {
                    if (this.validateFile(file)) {
                        this.processFile(file);
                    }
                });
            }

            validateFile(file) {
                const validTypes = [
                    'video/mp4', 'video/webm', 'video/ogg',
                    'image/jpeg', 'image/jpg', 'image/png', 'image/webp', 'image/gif'
                ];
                
                if (!validTypes.includes(file.type)) {
                    this.showStatus('ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼', 'error');
                    return false;
                }
                
                if (file.size > 50 * 1024 * 1024) { // 50MB
                    this.showStatus('æ–‡ä»¶å¤ªå¤§ï¼Œè¯·é€‰æ‹©å°äº50MBçš„æ–‡ä»¶ï¼', 'error');
                    return false;
                }
                
                return true;
            }

            processFile(file) {
                // æ£€æµ‹æ–‡ä»¶åä¸­çš„æ•°å­—
                const filename = file.name;
                const numberMatch = filename.match(/^(\d+)\./);
                let slideNumber = numberMatch ? parseInt(numberMatch[1]) : null;
                
                // å¦‚æœæ–‡ä»¶åæ²¡æœ‰æ•°å­—ï¼Œä½¿ç”¨é€‰æ‹©çš„å¹»ç¯ç‰‡
                if (!slideNumber) {
                    slideNumber = parseInt(this.slideSelect.value);
                }
                
                if (!slideNumber || slideNumber < 1 || slideNumber > 32) {
                    this.showStatus('è¯·é€‰æ‹©æœ‰æ•ˆçš„å¹»ç¯ç‰‡ç¼–å·æˆ–åœ¨æ–‡ä»¶åå‰åŠ ä¸Šæ•°å­—ï¼', 'error');
                    return;
                }

                this.uploadFile(file, slideNumber);
            }

            uploadFile(file, slideNumber) {
                this.showProgress();
                
                // æ¨¡æ‹Ÿä¸Šä¼ è¿›åº¦
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        this.hideProgress();
                        this.addMediaFile(file, slideNumber);
                        this.showStatus(`æ–‡ä»¶å·²æ·»åŠ åˆ°ç¬¬${slideNumber}å¼ å¹»ç¯ç‰‡ï¼`, 'success');
                    }
                    this.updateProgress(progress);
                }, 100);
            }

            addMediaFile(file, slideNumber) {
                const url = URL.createObjectURL(file);
                
                // å°†æ–‡ä»¶è½¬æ¢ä¸ºBase64ä»¥ä¾¿æŒä¹…ä¿å­˜
                const reader = new FileReader();
                reader.onload = (e) => {
                    const mediaData = {
                        file: file,
                        url: url, // ä¸´æ—¶URLç”¨äºå½“å‰é¡µé¢
                        base64: e.target.result, // Base64æ•°æ®ç”¨äºæŒä¹…ä¿å­˜
                        type: file.type.startsWith('video/') ? 'video' : 'image',
                        slideNumber: slideNumber,
                        slideName: this.slideNames[slideNumber],
                        timestamp: new Date().toLocaleString(),
                        fileName: file.name,
                        fileSize: file.size,
                        mimeType: file.type
                    };

                    this.mediaFiles.set(slideNumber, mediaData);
                    this.updateMediaGrid();
                    this.saveToLocalStorage();
                };
                reader.readAsDataURL(file);
            }

            updateMediaGrid() {
                this.mediaGrid.innerHTML = '';
                
                // æŒ‰å¹»ç¯ç‰‡ç¼–å·æ’åº
                const sortedMedia = Array.from(this.mediaFiles.entries()).sort((a, b) => a[0] - b[0]);
                
                sortedMedia.forEach(([slideNumber, mediaData]) => {
                    const card = this.createMediaCard(mediaData);
                    this.mediaGrid.appendChild(card);
                });
            }

            createMediaCard(mediaData) {
                const card = document.createElement('div');
                card.className = 'media-card';
                
                card.innerHTML = `
                    <div class="media-preview">
                        ${mediaData.type === 'video' 
                            ? `<video src="${mediaData.url}" controls muted></video>`
                            : `<img src="${mediaData.url}" alt="Slide ${mediaData.slideNumber}">`
                        }
                    </div>
                    <div class="media-info">
                        <h3>ç¬¬${mediaData.slideNumber}å¼ å¹»ç¯ç‰‡</h3>
                        <p>${mediaData.slideName}</p>
                        <p>ç±»å‹: ${mediaData.type === 'video' ? 'è§†é¢‘' : 'å›¾ç‰‡'}</p>
                        <p>å¤§å°: ${this.formatFileSize(mediaData.file.size)}</p>
                        <p>æ·»åŠ æ—¶é—´: ${mediaData.timestamp}</p>
                    </div>
                    <div class="media-actions">
                        <button class="btn btn-primary" onclick="mediaManager.previewInSlideshow(${mediaData.slideNumber})">é¢„è§ˆ</button>
                        <button class="btn btn-danger" onclick="mediaManager.removeMedia(${mediaData.slideNumber})">åˆ é™¤</button>
                    </div>
                `;
                
                return card;
            }

            previewInSlideshow(slideNumber) {
                // åœ¨æ–°çª—å£æ‰“å¼€å¹»ç¯ç‰‡å¹¶è·³è½¬åˆ°æŒ‡å®šé¡µé¢
                const url = `index.html#slide=${slideNumber}`;
                window.open(url, '_blank');
            }

            removeMedia(slideNumber) {
                if (confirm(`ç¡®å®šè¦åˆ é™¤ç¬¬${slideNumber}å¼ å¹»ç¯ç‰‡çš„åª’ä½“æ–‡ä»¶å—ï¼Ÿ`)) {
                    const mediaData = this.mediaFiles.get(slideNumber);
                    if (mediaData) {
                        URL.revokeObjectURL(mediaData.url);
                        this.mediaFiles.delete(slideNumber);
                        this.updateMediaGrid();
                        this.saveToLocalStorage();
                        this.showStatus(`å·²åˆ é™¤ç¬¬${slideNumber}å¼ å¹»ç¯ç‰‡çš„åª’ä½“æ–‡ä»¶`, 'success');
                    }
                }
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            showProgress() {
                this.progressContainer.style.display = 'block';
            }

            hideProgress() {
                this.progressContainer.style.display = 'none';
                this.updateProgress(0);
            }

            updateProgress(percentage) {
                this.progressFill.style.width = percentage + '%';
            }

            showStatus(message, type) {
                this.statusMessage.textContent = message;
                this.statusMessage.className = `status-message status-${type}`;
                this.statusMessage.style.display = 'block';
                
                setTimeout(() => {
                    this.statusMessage.style.display = 'none';
                }, 3000);
            }

            saveToLocalStorage() {
                const mediaData = {};
                this.mediaFiles.forEach((data, slideNumber) => {
                    mediaData[slideNumber] = {
                        url: data.base64 || data.url, // ä¼˜å…ˆä½¿ç”¨base64ï¼Œfallbackåˆ°url
                        type: data.type,
                        slideNumber: data.slideNumber,
                        slideName: data.slideName,
                        timestamp: data.timestamp,
                        fileName: data.fileName,
                        fileSize: data.fileSize,
                        mimeType: data.mimeType
                    };
                });
                localStorage.setItem('slideshowMediaFiles', JSON.stringify(mediaData));
                console.log('ğŸ’¾ ä¿å­˜äº†', Object.keys(mediaData).length, 'ä¸ªåª’ä½“æ–‡ä»¶åˆ°localStorage');
            }

            loadExistingMedia() {
                const savedData = localStorage.getItem('slideshowMediaFiles');
                if (savedData) {
                    try {
                        const mediaData = JSON.parse(savedData);
                        console.log('å·²åŠ è½½ä¿å­˜çš„åª’ä½“æ–‡ä»¶:', Object.keys(mediaData).length + 'ä¸ª');
                        // æ³¨æ„ï¼šä»localStorageåŠ è½½çš„URLå¯èƒ½å·²å¤±æ•ˆï¼Œè¿™é‡Œåªæ˜¾ç¤ºä¿¡æ¯
                        this.updateMediaGrid();
                    } catch (error) {
                        console.error('åŠ è½½åª’ä½“æ–‡ä»¶å¤±è´¥:', error);
                    }
                }
            }

            loadExistingMediaFromFiles() {
                // è¿™ä¸ªæ–¹æ³•ç”¨äºä»å®é™…çš„mediaç›®å½•åŠ è½½æ–‡ä»¶
                // åœ¨å®é™…éƒ¨ç½²ä¸­ï¼Œéœ€è¦åç«¯APIæ”¯æŒ
                console.log('å°è¯•ä»mediaç›®å½•åŠ è½½ç°æœ‰æ–‡ä»¶...');
            }

            exportMediaList() {
                const mediaList = [];
                this.mediaFiles.forEach((data, slideNumber) => {
                    mediaList.push({
                        slide: slideNumber,
                        name: data.slideName,
                        type: data.type,
                        fileName: data.file.name,
                        size: data.file.size
                    });
                });
                
                console.log('åª’ä½“æ–‡ä»¶åˆ—è¡¨:', mediaList);
                return mediaList;
            }
        }

        // åˆå§‹åŒ–åª’ä½“ç®¡ç†å™¨
        const mediaManager = new MediaUploadManager();
        
        // å…¨å±€æš´éœ²
        window.mediaManager = mediaManager;
    </script>
</body>
</html>